<nav
  class="
    bg-white shadow-sm border-b border-gray-200 fixed top-0 left-0 right-0 z-50
  "
>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8" data-controller="mobile-menu">
    <div class="flex justify-between items-center h-16">
      <!-- Mobile sidebar button and Logo/Brand -->
      <div class="flex items-center">
        <% if content_for?(:sidebar) %>
          <button
            type="button"
            class="-m-2.5 p-2.5 text-gray-700 lg:hidden mr-4"
            data-controller="mobile-sidebar"
            data-action="click->mobile-sidebar#open"
          >
            <span class="sr-only">Open sidebar</span>
            <%= icon 'menu', class: 'h-6 w-6' %>
          </button>
        <% end %>
        <%= link_to root_path, class: "flex items-center space-x-2" do %>
          <div
            class="
              w-8 h-8 bg-gradient-to-r from-blue-500 to-purple-600 rounded-lg flex
              items-center justify-center
            "
          >
            <span class="text-white font-bold text-sm">S</span>
          </div>
          <span class="text-xl font-semibold text-gray-900">SaaS Starter</span>
        <% end %>
      </div>
      <!-- Desktop Navigation -->
      <div class="hidden md:flex items-center space-x-8">
        <% if authenticated? %>
          <!-- Authenticated Navigation -->
          <%= link_to "Dashboard",
          root_path,
          class:
            "text-gray-700 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors" %>
          <%= link_to "Pricing",
          pricing_path,
          class:
            "block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors" %>
          <div class="relative" data-controller="dropdown">
            <button
              type="button"
              data-action="click->dropdown#toggle"
              class="
                flex items-center space-x-2 text-gray-700 hover:text-gray-900 px-3 py-2 text-sm
                font-medium transition-colors
              "
            >
              <% if Current.user.avatar_url.present? %>
                <img
                  src="<%= Current.user.avatar_url %>"
                  alt="<%= Current.user.name || Current.user.email_address %>"
                  class="w-8 h-8 rounded-full border border-gray-200"
                  referrerpolicy="no-referrer"
                  crossorigin="anonymous"
                >
              <% else %>
                <div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center border border-gray-200">
                  <span class="text-xs font-medium text-gray-700">
                    <%= (Current.user.name&.first || Current.user.email_address.first).upcase %>
                  </span>
                </div>
              <% end %>
              <% if Current.user.name.present? %>
                <span class="hidden sm:block text-sm font-medium text-gray-900"><%= Current.user.name.split(" ").first %></span>
              <% end %>
              <%= icon 'chevron-down', class: 'w-4 h-4' %>
            </button>
            <!-- Dropdown Menu -->
            <div
              data-dropdown-target="menu"
              class="
                hidden absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg border
                border-gray-200 py-1 z-50
              "
            >
              <div class="px-4 py-2 border-b border-gray-100">
                <% if Current.user.name.present? %>
                  <p class="text-sm font-medium text-gray-900 truncate"><%= Current.user.name %></p>
                  <p class="text-sm text-gray-500 truncate"><%= Current.user.email_address %></p>
                <% else %>
                  <p class="text-sm text-gray-500">Signed in as</p>
                  <p class="text-sm font-medium text-gray-900 truncate"><%= Current.user.email_address %></p>
                <% end %>
              </div>
              <%= link_to "Settings",
              settings_path,
              class:
                "block px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors" %>
              <%= button_to "Sign out",
              signout_path,
              method: :delete,
              class:
                "w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-50 transition-colors border-0 bg-transparent" %>
            </div>
          </div>
        <% else %>
          <!-- Unauthenticated Navigation -->
          <%= link_to "Features",
          "#features",
          class:
            "text-gray-700 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors" %>
          <%= link_to "Pricing",
          "#pricing",
          class:
            "text-gray-700 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors" %>
          <div class="flex items-center space-x-4">
            <%= link_to "Sign in",
            signin_path,
            class:
              "text-gray-700 hover:text-gray-900 px-3 py-2 text-sm font-medium transition-colors" %>
            <%= link_to "Get Started",
            signup_path,
            class:
              "bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg text-sm font-medium transition-colors" %>
          </div>
        <% end %>
      </div>
      <!-- Mobile menu button -->
      <div class="md:hidden">
        <button
          type="button"
          data-action="click->mobile-menu#toggle"
          class="
            inline-flex items-center justify-center p-2 rounded-md text-gray-700
            hover:text-gray-900 hover:bg-gray-100 transition-colors
          "
        >
          <span data-mobile-menu-target="openIcon">
            <%= icon 'menu', class: 'w-6 h-6' %>
          </span>
          <span data-mobile-menu-target="closeIcon" class="hidden">
            <%= icon 'close', class: 'w-6 h-6' %>
          </span>
        </button>
      </div>
    </div>
    <!-- Mobile Navigation Menu -->
    <div
      data-mobile-menu-target="menu"
      class="hidden md:hidden border-t border-gray-200"
    >
      <div class="px-2 pt-2 pb-3 space-y-1">
        <% if authenticated? %>
          <%= link_to "Dashboard",
          root_path,
          class:
            "block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors" %>
          <%= link_to "Pricing",
          pricing_path,
          class:
            "block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors" %>
          <div class="px-3 py-2 border-t border-gray-200 mt-2">
            <% if Current.user.name.present? %>
              <div class="flex items-center space-x-3">
                <% if Current.user.avatar_url.present? %>
                  <img
                    src="<%= Current.user.avatar_url %>"
                    alt="<%= Current.user.name %>"
                    class="w-8 h-8 rounded-full border border-gray-200"
                    referrerpolicy="no-referrer"
                    crossorigin="anonymous"
                  >
                <% else %>
                  <div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center border border-gray-200">
                    <span class="text-xs font-medium text-gray-700"><%= (Current.user.name&.first || Current.user.email_address.first).upcase %></span>
                  </div>
                <% end %>
                <div>
                  <p class="text-sm font-medium text-gray-900"><%= Current.user.name %></p>
                  <p class="text-sm text-gray-500"><%= Current.user.email_address %></p>
                </div>
              </div>
            <% else %>
              <p class="text-sm text-gray-500">Signed in as</p>
              <p class="text-sm font-medium text-gray-900"><%= Current.user.email_address %></p>
            <% end %>
          </div>
          <%= link_to "Settings",
          settings_path,
          class:
            "block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors" %>
          <%= button_to "Sign out",
          signout_path,
          method: :delete,
          class:
            "w-full text-left px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors border-0 bg-transparent" %>
        <% else %>
          <%= link_to "Features",
          "#features",
          class:
            "block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors" %>
          <%= link_to "Pricing",
          "#pricing",
          class:
            "block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors" %>
          <%= link_to "Sign in",
          signin_path,
          class:
            "block px-3 py-2 text-base font-medium text-gray-700 hover:text-gray-900 hover:bg-gray-50 rounded-md transition-colors" %>
          <%= link_to "Get Started",
          signup_path,
          class:
            "block px-3 py-2 text-base font-medium bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors" %>
        <% end %>
      </div>
    </div>
  </div>
</nav>

